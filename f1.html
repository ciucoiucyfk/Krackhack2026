<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>PlateWise | Precision Nutrition</title>

<script src="https://cdn.tailwindcss.com"></script>
<link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;600;800&display=swap" rel="stylesheet">

<style>
body { font-family: 'Plus Jakarta Sans', sans-serif; background-color: #f0f7f4; overflow-x: hidden; }
.glass-card { background: rgba(255, 255, 255, 0.95); backdrop-filter: blur(10px); }
.hidden { display: none; }
.goal-btn.active { transform: scale(1.05); background-color: white; }
.pref-btn.active { background-color: #4CAF50; color: white; border-color: #4CAF50; }
</style>
</head>

<body>

<!-- ================= SETUP PAGE ================= -->
<div id="setup-page" class="min-h-screen flex items-center justify-center p-6">

<div class="glass-card rounded-[3rem] shadow-2xl max-w-5xl w-full grid grid-cols-1 md:grid-cols-2 overflow-hidden">

<!-- LEFT PANEL -->
<div class="bg-gradient-to-br from-green-500 to-emerald-700 p-12 text-white flex flex-col justify-between">
<div>
<h1 class="text-4xl font-800 mb-4">PlateWise</h1>
<p class="italic">"Consistency builds the body. Discipline builds the life."</p>
</div>
</div>

<!-- RIGHT PANEL -->
<div class="p-12 space-y-8">

<h2 class="text-2xl font-bold text-gray-800">Customize Your Plan</h2>

<!-- Goal -->
<div>
<label class="block text-sm font-bold text-gray-500 uppercase mb-4">Select Your Goal</label>
<div class="grid grid-cols-3 gap-4">
<button onclick="selectGoal(this)" class="goal-btn p-4 rounded-2xl bg-blue-50">
ðŸ“‰ Weight Loss
</button>
<button onclick="selectGoal(this)" class="goal-btn p-4 rounded-2xl bg-orange-50">
ðŸ’ª Build Muscle
</button>
<button onclick="selectGoal(this)" class="goal-btn p-4 rounded-2xl bg-green-50">
ðŸŒ¿ Eat Clean
</button>
</div>
</div>

<!-- Preference -->
<div>
<label class="block text-sm font-bold text-gray-500 uppercase mb-4">Dietary Preference</label>
<div class="flex gap-2">
<button onclick="selectPref(this)" class="pref-btn px-6 py-2 rounded-full border-2">Vegetarian</button>
<button onclick="selectPref(this)" class="pref-btn px-6 py-2 rounded-full border-2">Vegan</button>
<button onclick="selectPref(this)" class="pref-btn px-6 py-2 rounded-full border-2">Non-Veg</button>
</div>
</div>

<!-- Allergies -->
<div>
<label class="block text-sm font-bold text-gray-500 uppercase mb-2">Allergies</label>
<input id="allergy-input" type="text"
placeholder="e.g. Peanuts, Dairy"
class="w-full bg-gray-50 rounded-xl p-4">
</div>

<!-- Budget -->
<div>
<div class="flex justify-between text-sm font-bold text-gray-500 uppercase mb-4">
<span>Budget Level</span>
<span id="budget-val" class="text-green-600">Moderate</span>
</div>
<input type="range" min="1" max="3" value="2"
oninput="updateBudget(this)"
class="w-full accent-green-500">
</div>

<button onclick="generatePlan(event)"
class="w-full bg-green-500 text-white py-5 rounded-2xl font-bold text-xl">
Generate My Plan â†’
</button>

</div>
</div>
</div>

<!-- ================= RESULTS PAGE ================= -->
<div id="results-page" class="min-h-screen hidden flex items-center justify-center p-6">

<div class="glass-card rounded-[3rem] shadow-2xl max-w-6xl w-full p-12">

<h2 class="text-4xl font-bold mb-10">Your Daily Blueprint</h2>

<div class="grid grid-cols-1 md:grid-cols-3 gap-8 mb-12">

<div class="bg-gray-50 rounded-3xl p-6 text-center">
<p class="font-bold mb-4">Daily Calories</p>
<p id="calories-value" class="text-2xl font-bold">-- kcal</p>
</div>

<div class="bg-gray-50 rounded-3xl p-6 text-center">
<p class="font-bold mb-4">Target Protein</p>
<p id="protein-value" class="text-2xl font-bold">-- g</p>
</div>

<div class="bg-gray-50 rounded-3xl p-6 text-center">
<p class="font-bold mb-4">Estimated Cost</p>
<p id="cost-value" class="text-2xl font-bold">-- â‚¹</p>
</div>

</div>

<div id="meal-container" class="space-y-4"></div>

<button onclick="location.reload()" class="mt-8 text-green-600 font-bold">
Edit Selection
</button>

</div>
</div>

<!-- ================= SCRIPT ================= -->
<script>

let selectedGoal = "";
let selectedPref = "";
let selectedBudget = "Moderate";

function selectGoal(btn){
document.querySelectorAll('.goal-btn').forEach(b => b.classList.remove('active'));
btn.classList.add('active');
selectedGoal = btn.innerText.trim();
}

function selectPref(btn){
document.querySelectorAll('.pref-btn').forEach(b => b.classList.remove('active'));
btn.classList.add('active');
selectedPref = btn.innerText.trim();
}

function updateBudget(slider){
const vals = ["Low","Moderate","Premium"];
selectedBudget = vals[slider.value - 1];
document.getElementById('budget-val').innerText = selectedBudget;
}

async function generatePlan(event){

const btn = event.target;
btn.innerText = "Calculating...";
btn.disabled = true;

const payload = {
goal: selectedGoal,
preference: selectedPref,
budget: selectedBudget,
allergies: document.getElementById("allergy-input").value
};

try {

const response = await fetch("http://127.0.0.1:8000/generate-plan", {
method: "POST",
headers: { "Content-Type": "application/json" },
body: JSON.stringify(payload)
});

const data = await response.json();

displayResults(data);

} catch(err){
alert("Server error. Check backend.");
console.error(err);
}
}

function displayResults(data){

document.getElementById("calories-value").innerText = data.calories + " kcal";
document.getElementById("protein-value").innerText = data.protein + " g";
document.getElementById("cost-value").innerText = "â‚¹" + data.cost;

const container = document.getElementById("meal-container");
container.innerHTML = "";

data.meals.forEach(meal => {
container.innerHTML += `
<div class="flex justify-between bg-gray-50 p-4 rounded-xl">
<div>
<h4 class="font-bold">${meal.name}</h4>
<p class="text-gray-500">${meal.item}</p>
</div>
<div class="font-bold text-green-600">+${meal.kcal} kcal</div>
</div>
`;
});

document.getElementById("setup-page").classList.add("hidden");
document.getElementById("results-page").classList.remove("hidden");

}

</script>

</body>
</html>
